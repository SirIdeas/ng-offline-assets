!function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n,t){"use strict";var r=t(1),o=t(5);angular.module("ngOfflineAssets",[r._name,o._name]).constant("OA_VERSION","0.0.1")},function(e,n,t){"use strict";function r(e,n){"ngInject";return{restrict:"A",scope:{url:"=oaBg",from:"=oaFrom",dest:"=oaDest",important:"=oaImportant",loadingClass:"@oaLoadingClass",failClass:"@oaFailClass",fail:"&oaOnFail",removeLoading:"@oaRemoveLoadingClass"},link:function(t,r,o){e.download(t.url,function(e){n(function(){r.css("background-image","url("+e+")")},10)})}}}r.$inject=["offlineAssetsService","$timeout"],Object.defineProperty(n,"__esModule",{value:!0}),n._name=void 0;var o=t(2),i=n._name="oaBg";n.default=angular.module(i,[o._name]).directive(i,r)},function(e,n,t){"use strict";function r(e,n,t,r,o){"ngInject";function i(e,n){e.$resolvedUrl=n+"?"+e.$version++,e.$cbs=e.$cbs||[],angular.forEach(e.$cbs,function(n){n&&n(e.$resolvedUrl)})}function c(e,n){var t=d.get(e);t?t.$resolvedUrl&&n(t.$resolvedUrl):!function(){var n=function(){d.add(e,t),d.started()||(d.start(),d.next())};t={},t.$version=1,t.$url=new URL(e),t.$cbs=[],s.ready().then(function(){var r=f(t.$url);s.getFile(r).then(function(r){i(t,r.fileEntry.toURL()),o.head(e).then(function(e){var t=(!e.headers("content-length")||r.file.size==parseInt(e.headers("content-length")))&&(!e.headers("last-modified")||r.file.lastModifiedDate>new Date(e.headers("last-modified")));t||n()})}).catch(n)})}(),t.$cbs.push(n)}function u(e,n){var t=d.get(e);if(t){var r=t.$cbs.indexOf(n);r!=-1&&t.$cbs.splice(r,1)}}function a(e){l=e}var s=e,l=null,f=function(e){return[].concat((s.getDest()||"/").split("/")).concat(l||[]).concat(e.host.split(":")).concat(e.pathname.split("/")).filter(function(e){return""!=(e||"").trim()}).join("/")},d=new n(function(e,n,t){var o=f(n.$url);s.download(n.$url,o).then(function(e){r.log(["downloaded:",n.$url].join("")),i(n,e.toURL()),t()}).catch(function(n){r.error([e,n]),t()})});return{download:c,release:u,setDir:a}}r.$inject=["offlineAssetsFsService","work","$q","$log","$http"],Object.defineProperty(n,"__esModule",{value:!0}),n._name=void 0;var o=t(3),i=t(4),c=n._name="offlineAssets";n.default=angular.module(c,[o._name,i._name]).factory([c,"Service"].join(""),r)},function(e,n){"use strict";function t(e,n){"ngInject";function t(n){return n?function(){var t=e.defer(),r=[];return angular.forEach(arguments,function(e){r.push(e)}),r.unshift(t),d.then(function(){n.apply(n,r)}),t.promise}:d}function r(t){var r=e.defer(),o=function(){return{code:0,name:"QuotaRequestRejected"}};return h?r.reject(o()):(t||(t=0),t=a.currentQuota+Math.max(t,a.blockSize),g.requestQuota(t,function(e){e?(n.log(["requestQuotaGranted",e]),a.currentQuota=e,r.resolve(e)):(h=!0,r.reject(o()))},function(e){r.reject(e)})),r.promise}function o(n){var t=e.defer(),o=a.currentUsage+n-a.currentQuota;return o>0?r(o+10240).then(function(e){t.resolve()},function(e){t.reject(e)}):t.resolve(),t.promise}function i(n){var t=e.defer(),r=n.split("/"),o=function e(r,o){return"."!=r[0]&&""!=r[0]||(r=r.slice(1)),r.length?void o.getDirectory(r[0],{create:!0},function(n){e(r.slice(1),n)},function(e){t.reject(e)}):void t.resolve(n)};return o(r,s.root),t.promise}function c(n,t){function c(e){return function(n){"QuotaExceededError"===n.name?r().then(u,s.reject):(console.log(e),s.reject(n))}}function u(){var r=t.split("/");r.pop();e.when().then(function(){return i(r.join("/"))},c("mkdir")).then(function(){return m(t)},function(){}).then(function(e){return j(e)},function(){}).then(function(){return m(t,!0)},c("getFileEntry")).then(function(n){if(n){var t=e.defer();return n.createWriter(function(e){e.onwriteend=function(){s.resolve(n)},e.onerror=c("writer"),t.resolve(e)},t.reject),t.promise}},c("createWriter")).then(function(e){if(e){var t=new XMLHttpRequest;t.open("GET",n,!0),t.responseType="blob",t.onload=function(){200==t.status&&(window.blob=t.response,o(t.response.size).then(function(){e.write(t.response),a.currentUsage+=t.response.size},c("requestStorageQuotaIfRequired")))},t.send(null)}},c("finish"))}var s=e.defer();return u(),s.promise}function u(){return a.dest}var a={blockSize:16613376,currentQuota:0,currentUsage:0,dest:""},s=null,l=e.defer(),f=e.defer(),d=e.all([l.promise,f.promise]),v=window.requestFileSystem||window.webkitRequestFileSystem,g=navigator.webkitPersistentStorage||{requestQuota:function(){},queryUsageAndQuota:function(){}};"undefined"!=typeof cordova?(n.log("cordova on"),document.addEventListener("deviceready",function(){n.log("devideready"),v(LocalFileSystem.PERSISTENT,0,function(){n.log("requestFileSystem"),a.dest=cordova.file.externalDataDirectory||cordova.file.dataDirectory,l.resolve(),f.resolve(-1,-1)},function(e){l.reject(e),f.reject(e)})},!1)):(g.queryUsageAndQuota(function(e,t){n.log(["queryUsageAndQuota:",e,", ",t,", ",t-e,", ",a.blockSize].join("")),a.currentQuota=t,a.currentUsage=e,t-e<a.blockSize/2?r().then(f.resolve,f.reject):f.resolve(e,t)},function(e){f.reject(e)}),v(window.PERSISTENT,0,function(e){s=e,l.resolve()},function(e){l.reject(e)})),d.then(function(){n.log("ready")}).catch(n.error);var m=t(function(e,n,t){window.resolveLocalFileSystemURL?window.resolveLocalFileSystemURL(n,e.resolve,e.reject):s?s.root.getFile(n,{create:!!t},function(n){e.resolve(n)},function(n){e.reject(n)}):e.reject({code:0,name:"NotInstanceToGetFileEntry",message:"No handler instance to get file entry instance"})}),p=t(function(e,n){m(n).then(function(n){n.file(function(t){e.resolve({fileEntry:n,file:t})},function(n){e.reject(n)})}).catch(function(n){e.reject(n)})}),h=!1,j=function(n){if(n){var t=e.defer();return n.remove(function(e){t.resolve(n)},function(e){t.reject(e)}),t.promise}};return{ready:t,getFileEntry:m,getFile:p,requestStorageQuota:r,requestStorageQuotaIfRequired:o,mkdir:i,download:c,getDest:u}}t.$inject=["$q","$log"],Object.defineProperty(n,"__esModule",{value:!0});var r=n._name="offlineAssetsFs";n.default=angular.module(r,[]).factory([r,"Service"].join(""),t)},function(e,n){"use strict";function t(e,n){"ngInject";return function(e){var n=this,t={},r=[],o=!1,i=!1;n.add=function(e,c){t[e]=c,r.push(e),o||(o=!0,i&&n.next())},n.start=function(){i=!0},n.working=function(){return o},n.started=function(){return i},n.get=function(e){return t[e]},n.next=function(){if(o=!!r.length){var i=r.shift(),c=t[i];e(i,c,function(){n.next()})}}}}t.$inject=["$q","$log"],Object.defineProperty(n,"__esModule",{value:!0});var r=n._name="work";n.default=angular.module(r,[]).factory([r].join(""),t)},function(e,n,t){"use strict";function r(e,n){"ngInject";return{restrict:"A",scope:{url:"=oaSrc"},link:function(t,r,o){function i(e){n(function(){r.attr("src",e)},10)}e.download(t.url,i),r.on("$destroy",function(){e.release(t.url,i)})}}}r.$inject=["offlineAssetsService","$timeout"],Object.defineProperty(n,"__esModule",{value:!0}),n._name=void 0;var o=t(2),i=n._name="oaSrc";n.default=angular.module(i,[o._name]).directive(i,r)}]);